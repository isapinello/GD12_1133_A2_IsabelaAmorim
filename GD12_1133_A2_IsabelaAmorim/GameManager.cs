using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TitanExplorer
{
    public enum Direction { North, South, East, West } // Enum helps avoid potential errors with string comparisons
                                                       // Also simplifies the direction handling
    public class GameManager
    {
        private Room _currentRoom;
        private Room _startingRoom;
        private Random _random = new Random();
        private Player _player;

        public GameManager()
        {
            _player = new Player(); // Initialize the player here
            InitializeRooms();
        }
        public void InitializeRooms()
        {
            // Create the rooms
            Room heart = new BasicRoom("Heart", "The center of the Titan, with paths to other organs.", @"
████████████▓▓██████████████████████
████████████▒▓██████████████████████
████████████▓▓▓▒▓█▓▓██▒▓████████████
███████████▓▒▒▒▒▒▒▒▒▒▓▓▓▓███████████
███████████▓▒▒▒▒░▒▒▒▒▒▒▒▒▒▒█████████
███████████▒▒▒▓▒▒▒▒░░▒▒▒▒▒▒▒████████
████████▓▒▒▒▓▓█▓▒▒▒▓▒▒██▓▒▓█████████
███████▒▒▒▓▓▓███▓▒▒▒▒▒▒▓▒▒▒▒████████
██████▓▒▒▒▒▒▓▓█▓▒▒▓▒▓▓▒▒▒░░▒▒▒▒█████
██████▒▒▒▒▒▓▓▓▒▒▓▓▓▓█▓▓███▒▒▒▓██████
████████▓▓▒▒▒▓██████████▓▒▒▒▒▒▓█████
████████▓▓▒▓██████▓▓▓▓██▒▒▓▓▒▒▒▒████
██████▓▒▓██████▓▓▓██▓▒▒▓▓▒▒▓████████
████████████████▓▓▓█▓▓███▓██████████
██████▓▒▓▓▓▓▓▓▓▓▓▓██▓▓▓▓█▓▓█████████
███████▒░▒▒▒▒▒▒▒▓▓▓▓▓▓▒▒▓▒▒█████████
████████▒░░▒▒▒▒▒▒▓▓▓▒▒▒▒▒▓██████████
█████████▓░░░▒░▒▒▒▒▓▒▒▒▒▒▒██████████
███████████▒░░░░░▒▒▒▒▒▒▒▒▓██████████
█████████████▓░░░▒▒░░▒▒▒████████████
████████████████▒░░░░▒▒█████████████
███████████████████▓▓███████████████");
            Room head = new BasicRoom("Head", "The disfigured remains of the Titan's skull, now scavenged by unknown creatures. You can only exit through here", @"
█████████████████████████████████████████
████████▓▒▒▓█████▓▒▒░░░░░░███████████████
█████████▓▒▒▓▓▓▒▒░▒░░░░░░░░░▒▓███████████
████████▓▓▒▓▓▓█▒▒▒▓▒░░░░░░░░░▒▒▒█████████
█████████▒▒▒▓▓█▓█▓▒▓▓▒░▒▒░░░░▒▒▒▒▓███████
███████▓▒░▒▒░▒░▓█████▒▒░░░░░░░░▒▒▒▓██████
███████▓▓▓▒▒▒▒▓▒▒▓██▒▓▒░▒░░░░░░░░▒▒▓█████
██████████▒▒▒▓▓▒▒▓▒▓██▓▒▓█████▓░░░▒▒█████
█████▓▒▓▓▓▒▒▒▒▓▓▒░▓▓██▒▒▓█▓▓▓▓▓█▒▒▒▒█████
█████▓▒▒▒▒▓▒▒▓▓▓▒▓▓▓▒▒▒▓▒▓▓▓▒▓▒▒▒░▒▓█████
█████▒░░▒▒▓▓▓▓▓▒▓▓▓████▓▒░▒▓▓▓▒▒░▒▓██████
████▒░▒▒▒▒▒▒▒▓▓█▓▒██▓██▓▒░░░░░░░░▒▓██████
█████░░░░▒▒▓▒▒▒▒▒▒▓▓▒▒▒▒░░▒░░▒░▒▒▓▓██████
█████▓░░░▒▒▒▒▒▒▒▒▒░░░▒░▒░░▒░▒▓███████████
████████▓▒▒▒▒▒▓██▓▒▒▒▒▒░░░░▒▒░▒▒▓████████
███████████████▒▓▓▒▒▓▒▒▓▓▓▓▓▓░▒▓█████████
██████████████▓▒░▓▓▒▓▒░░░░▒▒▒░▒▓█████████
██████████████▓▓▓░▒▒▓▒▒▒▒▒░░░▒▒██████████
███████████████▒▒░░░░░░░░▒░▒▒▓███████████
█████████████████░░░░░░░░░░░░████████████
█████████████████████████████████████████");
            Room gut = new BasicRoom("Gut", "The stench of decay fills the air, with tunnels leading deeper into the body.", @"
████████████████████▓▒░░░▓███████████████
██████░▒▓███████████▓▒░░░▓░░░░░██████████
█████▒█▓░░▒▒▓██░░░░░░░▒██████▓▓▓▓▒░▓█████
█████▒█▓░░▓▒░▓█▓▒░▒░░▓█▓▓▓▓▓▓▓████▓▒▒▓███
███▒▓██░░▒░▒▒░░░██▓▒░▓▓▓▒▒▒░░▒▓████▓▓▒▓██
██▓▒██▓▒░▒░▓██▒░▒▒░███▒░░▒▓▓░░░▒███▓▓▒▓██
█▓▒███▓▒░▓▓█▒░▓██▒░█▓▒░░███▒░░░░▒███▓▓▒░█
█▒██▓▒░░░▒▒█▓░█▓▒░█░░░█▓▒▓░░▒░▓▓▒░██▓▓▒░█
█▓██▓▒░▒▒██▒███▓█▒▒░▓██▓░▒▒░░░░▒░░██▓▓▒░█
█▓██▓▒░▓█▒░░░▒▒▓██░░░░░░▒▒░▒▒░██▒░██▒▒░▒█
█▓██▒▓█░▓▓░░███▒░░░░███▒░░░░▒██▒░░██▒▒░▒█
█▒██▒▓██▓░▒░▒▒░░▒▒▒░░░░░███▒░░░░▓██▓▒▒░▒█
█▓▒▓█▒▒▓▒▒█▓▒▒░░░░░██▓▒░█▓▒░▒████▓▓▒▒▒▒██
███▒▓█▒██▓░░░░▒░░░█▓▒▒░░▓██▓▓▓▓▒▒▒▓▒▒▓██
████▒▓█▒▒▒▓███▒▒▒▒▒▒░▓████▓▓▒▒▒▒▒▒▒░████
█████▒▓▓▒▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒░░░░░░░▒▓█████
██████▒▓▓▒▒▓▓▓▓▓▓▓▓▒░░░░███████████████
███████████░░░░░░░░░░░░░███████████████
████████████████████▓▒░░░▒█████████████
");
            Room liver = new BasicRoom("Liver", "A massive, hardened organ, sitting to the east of the Heart.", @"█████████████████████████████████████████
███████████▓▓▒▒▒▒▒▒▒▒▒▒▓▓▓█▓▓▒▒▒░░░░░░▒▓█
████████▓▒░░░░░░░░░░░░░░░░▒░░░░░░░░░░░░░▓
█████▒░░░░░▒▒▒▒▒▒░░░░░░░░░░▒░░░░░░░░░░▓██
███▒░░░░░░░░░▒▒▒░░░░░░░░░░░▒▒▒▒▒░░░▒█████
██▒░░░░░▒▒▒▒▒▒▒▒▒░░░░░░░░░░░▒░░░░▒███████
█▓░░░░░░▒▒▒▒▒▒▒▒▒░░░░░░░░░░░▒░░▒▓████████
█▒░░░░░▒▒▒▒▒▒▒▒▒▒░░░░░░░░░░░░░▒▓█████████
█▒░░░░░▒▒▒▒▒▒▒░░░░░░░░░░░░░░▒▓███████████
█░░░░░░░░░░░░░░░░░░░░░░░▒▒▓██████████████
█▒░░░░░░░░░░░░░░░░░▒▒▒▒▒▓▓███████████████
█▒░░░░░░░░░░░░░▒▒▒▒▒▒▒███████████████████
█▒░░░░░░░░░▒▒▒▓▓▓▓▒░▒████████████████████
██░░░░░░░░▒▒▒▓▓▓▓▒░▒█████████████████████
██▓░░░░░▒▒▒▒▒▒▒▒▒▓███████████████████████
███▓▒░░▒▒▓███████████████████████████████
█████████████████████████████████████████");
            Room lung = new BasicRoom("Right Lung", "The titan's lungs still seem fresher than other parts, lying to the west of the Heart.", @"██████████████████▓▓▓████████████████████
███████████████████▓▓████████████████████
███████████████████▓▓████████████████████
█████████████▓█▓███▓▓█████▓▓▓████████████
██████████▓▓▓▓▓▓███▓▓████▓▓█▓▓███████████
█████████▓▓▓▓▓▓▓███▓▓████▓███████████████
███████▓▓▓▓▓▓▓▓▓▒▓▓▓▓▓███████████████████
██████▓▓▓▓▓▓▓▓▓███▓▓▓▓█▓█████████████████
█████▓▓▓▓▓▓▓▓▓▓▓▓█████▓▒█████████████████
█████▓▓▓▓▓▓▓▓▓▓▓▓▓▓███▓▓█████████████████
█████▓▓▓▓▓▓▓▓▓▓▓░▒▒████▓███▓█████████████
████▓▓▓▓▓▓▓▓▒▒▓▒▒░▓████▒▓▓▓▓█████████████
████▓▓▓▓▓▓▓▓▓▓▒▒▓▒█████▒▒▓█▓▓████████████
████▓▓▓▓▓▓▓▓▓▓▒▓▓██████▒▒████████████████
████▓▓▓▓▓▓▓▓▓▓▓▓▓██████▒▒████████████████
████▓▓▓▓▓▓▓▓▓▒▓▓▓██████▒▒▓███████████████
████▓▓▒▓▓▓▓▓▓▒▒▒▓███████▓▓██▓▓▓▓█████████
█████▒▒▓▓▓▓▓▓▓▒▓█████████▓▓▓▒▒▓██████████
█████▓▒▒▒▒▒██████████████▓█▓▓████████████
██████▓▒▒▒█████████████████▓█████████████
█████████████████████████████████████████
█████████████████████████████████████████");
            Room rightLeg = new BasicRoom("Right Leg", "The leg muscles are destroyed, the result of the titan’s desperate flight.", @"████████████▓▓▓▓▓██████████████
████████████▓▓▒▒▒▓█████████████
████████████▓▓▒▒▒▒█████████████
████████████▓▓▒▒▒▒▒████████████
████████████▓▓▒▒▓▒▒▒▓██████████
███████████▓▓▒▒▒▒▓▓▒▒▓█████████
█████████▓▓▓▓▒▒▒▒▓▓▓▒▒▓████████
█████████▓▓▓▓▓▓▓▓▒▒▒▒▒▒▓███████
████████▓▓▓▓▒▓▓▓▒▒▒▓▒▒▒████████
██████████▓▓▓▒▒▒▒▒▒▓▓▓▓████████
█████████▓▓▓▓▒▒▒▒▒▒▓▓▓▓████████
████████▓▓▓▓▒▒▓▒▒▒▒▒▒▒▓████████
████████▓▓▓▓▓▒▓▓▒▒▒▒▒▓█████████
███████▓▓▓▓▓▓▒▓▓▒▒░▒▓██████████
███████▓▓█▓▓▓▓▒▓▒▒▒▒▓██████████
███████▓▓▓▓▓▓▒▒▓▒▒▒▓███████████
███████▓▓▒▓▓▓▒▒▓▒▒▒▓███████████
███████▓▓▒▓▓▓▒▒▒▓▒▒▒▓██████████
███████▓▓▒▓█▓▒▒▒▓██▒▓██████████
███████▓▓▓▓██▓▒▒▓██▒▒▓█████████
███████▓▓▓▓██▓▒▒▓██▓▓▓█████████
██████▓▓▓▒▓██▓▒▒▒██▓▓▒▓████████
██████▓▓▓▓███▓▒▒▒██▓█▓▓▓███████
██████▓▓▓▓███▓▒▒▒▓█▓█▓▒▓███████
██████▓▓▓▓████▓▒▒▓█▓▓█▓▒▓██████
█████▓▓▓▒▒████▓▒▒▓▓▓▓▓▓▓▒▒▓████
████▒▒▓▒▒▓████▓▒▒▓▓█▓▒▓██▓▓████
█▓▓▒▓▓▓▓▓█████▓▒▒▒▒█▓▓▓████████
▓▒▓▓█▓▒▓██████▓▒▒▒▒██▓▓████████
██████████████▓▒▒▒▒▓███████████
██████████▓███▓▒▒▒▒▒▓██████████
██████████▓▓███▒▒▒▒▒▓██████████
█████▓▒▓▓█▓▒▓██▓▒▒▒▒▓██████████
█████▓▓▒▒▒▒▓▓███▒▒▒▒▓███▓▓█████
████████▓▓▒▓▓▓██▒▒▒▒▓███▓▓█████
██████████▓▒▓▒▓█▒▒▒▒▒██▓▓██████
███████████▓▒▒▒▓▒▒▒▒▒█▓▓▓██████
███████████▓▒▒▒▒▒▒▒▓▓▓▓▒▓██████
███████████▓▓▒▒▒▓▒▒▓▓▓▓▒▓██████
████████████▓▒▒▒▒▓▒▒▓▓▓▓▓██████
████████████▓▒▒▒▒▓▒▒▒▓▓▓▒▓█████
█████████████▒▒▒▒▓▓▒▓▓▓▓▓▓█████
█████████████▓▓▓▓▓▓▓▒▓▒▒▓██████
█████████████▓▓▓▓▓▓▓▒▒▒▒▓██████
█████████████▓▒▓▓▒▒▓▒▒▓▒▓██████
██████████████▓▓▓▒▒▓▓▓▓▒▒▓█████
██████████████▓▒▒▓▓▓▓▓▒▒▒▓█████
██████████████▓▒▓▓▓▓▒▒▒▒▓██████
██████████████▓▓█▓█▓▓▓▓▒▒▓█████
██████████████▓▓▓▓▓▓▓▓▓▓▒▓█████
█████████████▓▓▓▓▓▓▓▓▓▓▓▒▓█████
████████████▓▓▓▓▒▓▓▒▒▒▒▒▒▓█████
████████████▓▓▓▒▓▓▓▓▒▒▒▒▒▓█████
████████████▓▓▓▒▓▓▒▓▓▒▒▓▒▓█████
███████████▓▓█▓█▓▓▒▓▓▓▓▓▒▓█████
███████████▓█▓▒█▓▓██▓██▓▒▓█████
██████████▓▒▓▓▒█▓▓█▓▓██▓▒▓█████
██████████▓▓▓▒▒▓▒▒▓▓▒▒▓▓▒▒█████
█████████▓▓▓▓██▓▓▓▓▓▒▓▓▓▒▓█████
███████████▓▓██▒██▓▓██▓▓▓██████
███████████▓██▓▓█▓▓▓██▓▒▓██████
██████████████▓██▓▓███▓▓███████
█████████████████▓███▓▓████████");
            Room leftLeg = new BasicRoom("Left Leg", "This leg seems less deteriorated compared to the rest. Strange markings cover its surface from the inside.", @"████████████▓▓▒▓▓▓▒████████████
████████████▓▒▒▒▓▓▒████████████
███████████▓▓▒▒▓▓▓▒████████████
██████████▓▓▒▒▒▓▓▓▓████████████
█████████▓▓▒▒▒▒▓▓▒▓████████████
███████▓▓▓▓▓▒▒▒▓▒▒▓▓███████████
██████▓▓▓▓▓▓▒▒▓▓▓▓▒▒▓██████████
██████▓▓▓▓▓▓▓▒▓▓▓▒▒▒▓▓█████████
██████▓▓▓▓▓▓▓▒▒▓▓▒▒▒▒▓█████████
███████▓▓▓▓▓▓▒▒▓▓▒▒▒▓██████████
███████▓▓█▓▓▓▒▒▓▒▓▒▒▒██████████
███████▓▓▓▓▓▓▒▒▓▓▓▓▒▒██████████
██████▓▓██▓▓▓▒▓▓▓▓▓▒▒▓█████████
██████▓▓██▓▓▓▒▓▓▓▓▓▓▒▒▓████████
█████▓▓▓▓█▓▓▓▒▓▓▓▓▓▓▒▒▓████████
█████▓▓▓▓▓▓▓▓▒▓▓▓▓▓▓▒▒▒▓███████
████▓▓▓▓▓▓▓▓▒▒▓▓▓▓▓▓▒▒▒▓███████
████▓▓▓▓▓▓▓▓▒▒▒▓▓▓▓▓▒▒▒▓███████
████▓▓▓▓▓▓▓▒▒▒▒▓▓▓▓▓▒▒▒▓███████
███▓▓▓▓▓▓▓▒▒▒▒▒▓▓▓▓▒▒▒▒▓███████
███▓▓▓▓▓▓▒▒▒▒▒▒▒▓▒▒▒▒▒▒▓███████
███▓▓▓▓▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓███████
███▓▒▒▓▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓███████
███▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒████████
███▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓████████
████▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒█████████
████▓▒▒▒▒▒▒▒▒▒▒▒░▒▒▒▒▓█████████
█████▒▒▒▒▒▒▒▒▒▒▒░▒▒▒▒▓█████████
█████▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒██████████
█████▓▒▒▒▒▒▒▒▒▒▒▒▒▒▒▓██████████
█████▓▒▓▒▒▓▓▓▓▓▓▒▒▒▒███████████
█████▓▒▓▓▓▓▓▓▓▓▒▒▒▒▓███████████
██████▓▓▓▓▓▓▓▓▓▒▒▒▓████████████
██████▓▓▓▓▓▓▓▓▒▒▒▒▓████████████
███████▓▓▓▓▓▓▓▒▒▒▒█████████████
███████▓▓▓▓▓▓▒▒▒▒▓█████████████
███████▓▓▓▓▓▓▒▒▒▒▓█████████████
███████▓▓▓▓▓▒▒▒▒▒██████████████
██████▓▓▓▓▓▓▒▒▒▒▒██████████████
██████▓▓▓▓▓▓▒▒▒▒▓██████████████
██████▓▓▓▓▓▒▒▒▒▓███████████████
██████▓▓▓▓▓▒▒▒▓▓███████████████
██████▓▓▓▓▓▒▓▓▒████████████████
██████▓▓▓▓▓▒▓▓▓████████████████
█████▓▓▓█▓▓▒▒▓▓████████████████
████▓▓▓▓▓▓▓▒▒▒▒████████████████
█████▓▓▓▓▓▒▒▒▒▒▓███████████████
█████▓▒▒▒▒▒▒▒▒▒████████████████
█████▓▒▒▒▒▒▒▒▒▓████████████████
█████▓▒▒░▒▒▒▒▒▒████████████████
████▓▓▒▒▒▒▒▓▓▓▒▓▓██████████████
█████▓▒▒▒▓▒▒▓▒▓▓▒██████████████
█████▓▓▓▒▒▒▒▒▒▓▓▒██████████████
████▓▓▓▒▒▒▒▒▒▓▒▓▓▓█████████████
████▓▓▒▒▓▒▓▓▓█▓▓█▓█████████████
████▓▓▒█▓▒▓█▒██▓█▓▓████████████
████▓▓▓██▓▓█▓▓█▓▒▓▓████████████
████▓▓▒▓▓▓▒▓▓▓▓▓▓▓▓▓███████████
████▓▒▒▓▓▓▒▓▓▓▓█▓▓█▓███████████
█████▓▓▓██▓▓██▓██▓▓████████████
█████▓▓▓██▓▒██▓▓█▓▓████████████
██████▓▒███▓██▓▓███████████████
███████▓███▓███████████████████");

            // Set room exits
            SetExits(heart, (Direction.North, head), (Direction.South, gut), (Direction.East, liver), (Direction.West, lung));
            SetExits(head, (Direction.South, heart));
            SetExits(gut, (Direction.East, leftLeg), (Direction.West, rightLeg), (Direction.North, heart));
            SetExits(rightLeg, (Direction.East, gut));
            SetExits(leftLeg, (Direction.West, gut));
            SetExits(liver, (Direction.West, heart));
            SetExits(lung, (Direction.East, heart));

            _currentRoom = head;
            _startingRoom = head;
        }

        private void SetExits(Room room, params (Direction direction, Room room)[] exits)
        {
            foreach (var exit in exits)
            {
                room.AddExit(exit.direction, exit.room);
            }
        }

        public void Start()
        {
            Console.ForegroundColor = ConsoleColor.DarkRed;
            Console.WriteLine(@"░▒▓████████▓▒░▒▓█▓▒░▒▓████████▓▒░▒▓██████▓▒░░▒▓███████▓▒░       ░▒▓████████▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓███████▓▒░░▒▓█▓▒░      ░▒▓██████▓▒░░▒▓███████▓▒░░▒▓████████▓▒░▒▓███████▓▒░  
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░ 
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░ 
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓████████▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓██████▓▒░  ░▒▓██████▓▒░░▒▓███████▓▒░░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░▒▓███████▓▒░░▒▓██████▓▒░ ░▒▓███████▓▒░  
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░ 
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░     ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░ 
   ░▒▓█▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░      ░▒▓████████▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓████████▓▒░▒▓██████▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓████████▓▒░▒▓█▓▒░░▒▓█▓▒░");
            Console.ResetColor();

            while (true)
            {
                DisplayCurrentRoom();

                // Check for combat opportunity
                if (_currentRoom == _startingRoom)
                {
                    Console.Write("\nWhich direction do you want to go? ");
                    string? input = Console.ReadLine()?.ToLower();
                    if (input == "exit")
                    {
                        Console.WriteLine("You have successfully exited the titan's head. Goodbye!");
                        break;
                    }

                    // Attempt to move to another room
                    if (!TryMove(input))
                    {
                        Console.WriteLine("You can't go that way.");
                    }
                    continue; // Skip the combat check if in the starting room
                }

                // Check for an encounter
                int encounterChance = _random.Next(1, 4); // 1 in 3 chance for an encounter
                if (encounterChance == 1)
                {
                    CombatSystem combatSystem = new CombatSystem(_player);
                    combatSystem.StartCombat(); // Start combat with possible multiple enemies

                    if (_player.HP <= 0) // Check if the player is defeated
                    {
                        Console.WriteLine("You have been defeated! Game Over.");
                        break; // Exit the game loop if defeated
                    }
                }

                Console.Write("\nWhich direction do you want to go? ");
                string? inputDirection = Console.ReadLine()?.ToLower();
                if (inputDirection == "exit")
                {
                    Console.WriteLine("You have successfully exited the titan's head. Goodbye!");
                    break;
                }

                if (!TryMove(inputDirection))
                {
                    Console.WriteLine("You can't go that way.");
                }
            }

            Console.WriteLine("Thanks for playing!");
        }

        private bool TryMove(string? input)
        {
            if (Enum.TryParse<Direction>(input, true, out Direction direction) && _currentRoom.Exits.TryGetValue(direction, out Room? nextRoom))
            {
                _currentRoom = nextRoom;
                return true;
            }

            return false;
        }

        private void DisplayCurrentRoom()
        {
            Console.WriteLine($"\nYou are in the {_currentRoom.Name}");
            Console.WriteLine(_currentRoom.Description);
            Console.WriteLine(_currentRoom.Art);
            Console.WriteLine("Exits: " + string.Join(", ", _currentRoom.GetAvailableExits()));
        }
    }
}